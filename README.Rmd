---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, eval=FALSE, echo=FALSE}
# this file was created with the following command:
usethis::use_readme_rmd()
```


# Introduction

The goal of scities is to provide teaching materials for the Digital Methods workshop as part of the Sustainable Cities Masters at the University of Leeds.

In-line with the content, these materials were developed using new digital methods.
This file was generated using an 'RMarkdown' file: `README.Rmd`.
Why this file format instead of something like `README.md` or (worse) `README.docx`?
Because you can include R chunks like this:

```{r cars}
d = Sys.Date()
msg = "Welcome to the digital methods workshop on "
print(paste0(msg, d))
```

The date automatically changes each time we build ('compile') the document.
Automation is an important concept in digital methods.
It's also practically useful.
Automation saves time!

This document is also reproducible, which is vital for democratically accountable and transparent decision-making.
But it depends on some software to be reproduced:
a recent version of R must be installed.
Then from within R you must install some packages.
Entering these commands into the 'R terminal' will install them for you:

```{r}
pkgs = c(
  "osmdata",   # for working with open street map data
  "sf",        # a package for working with spatial data
  "stplanr",   # a transport data package
  "tidyverse", # metapackage for data science
  "tmap"       # a mapping package
)

pkgs_installed = pkgs %in% installed.packages()
names(pkgs_installed) = pkgs
pkgs_installed
if(!all(pkgs_installed)) {
  install.packages(pkgs[!pkgs_installed])
}
```


```{r, message=FALSE}
devtools::install_github("robinlovelace/ukboundaries")
```

You can check these have been installed properly with the following commands:

```{r, message=FALSE}
library(sf)
library(stplanr)
library(tidyverse)
```



## Spatial data

We will be using R / RStudio, the open source software for all analysis and data manipulations. An introdcton to geting started in R/RStdio can be found at https://rpubs.com/chrisbrunsdon/UQ_rbasics - this will explain how to install R / RStudio and critically specific packages with specific functionality (eg for reading spatial data, making maps etc).

Cities are spatial entities so you should know some GIS concepts before grappling with city data.
The introductory comments of Chapter 2 in the open source and open access book [Geocomputation with R](https://geocompr.robinlovelace.net/spatial-class.html) provide an overview of spatial data models.

In brief, real-world discrete geographic features are represented in spatial databases using vectors of points, lines and areas. For example, point to represent a shop, address or postcode location, lines for linear features such roads and areas for things likes parks, zones, building outlines etc. Continuous features (eg temperature surfaces) are frequently repsented by gridded or raster data. The *spatial* objects provide a framework for hanging information or *attributes* about these features. This could be the number of people living in each house, the area of a park, the opening times of a shop etc, and each object can have multiple attributes that are usually held in some form data table. Thus a spatial database holds information about the location and extent of geographic features and their properties or *attributes*.

There are 1000s of R packages and the `sf` (Simple Features) package provides formats for spatial dat aand their analysis. The `sf` vignette provides an introduction to vector data and formal descriptions of spatial formats: https://cran.r-project.org/web/packages/sf/vignettes/sf1.html

You will be provided with all the materials you need to do this practical work. Then later, in your own time, if you are interested in developing these skills further.....there are a number of further reources that you may find useful: 

- To get started with spatial data in R have a look at the practical at https://rpubs.com/lexcomber/session4. 
- For more in-depth information, you can read sections [2.2.5](https://geocompr.robinlovelace.net/spatial-class.html#geometry) and (for 'raster' data) [2.3](https://geocompr.robinlovelace.net/spatial-class.html#raster-data) of the same resource.
- There is an excellent introductory text on spatial analysis and mapping in R: https://uk.sagepub.com/en-gb/eur/an-introduction-to-r-for-spatial-analysis-and-mapping/book258267 2nd edition coming in December 2018!
- More advanced methods for manipulating spatial data can be found in Bivand et al (2008) 
see http://gis.humboldt.edu/OLM/r/Spatial%20Analysis%20With%20R.pdf (this assumes you know what you want to do)

We encourage you to search-for other resources on spatial data: there's lots out there and, like everything in digital methods, is rapidly evolving!

**Key point**: spatial data describe the location and outline where appropriate of real-world geographic features. The *attribites* of individual features are held in some form of data table (similar to a spreadsheet).

## Data sources
[traditional (eg census) and new (eg open street map]

### Traditional data (population census etc)
Traditional city/transport planning uses official datasets. There are many sources of spatial data and it is impossibel to list all of them. Much geographic or spatial data about cities is provided by the population census, conducted every 10 years. This summarises individual household census returns to geographic areas - you may have heard of Wards, but data can be obtained for a number of different geographies from Output Area (small, about 300 people) to countries (large) via, Lower Super Output Areas (~1500 people), Medium Super Output Areas (~7500 people), local authorities, countes and unitary authorities and regions.

In the UK, census data for these areas can be easily obtained from 2 sources. 

1) Nomisweb for census data attributes (data tables) - https://www.nomisweb.co.uk
2) UKBorders for census data zones (areas) - https://borders.ukdataservice.ac.uk/bds.html

After downloading the data tables need to be linked to the zones and this is done through a common key usually the census area codes, which are unique for each area.

**Key point**: data for different geographic *zones* in the UK and their properties can be easiliy downloaded from open respitories and then linked together.

An example of this is official zoning systems, such as the 'LSOA' zones loaded and plotted below:

```{r}
zones_leeds = ukboundaries::lsoa2011_lds
plot(zones_leeds)
```

### Alternative data sources

Unofficial datasets, such as those provided by the OpenStreetMap project are messier but in some cases richer.
An exmaple is provided below, which downloads and plots parks in Leeds:


```{r}
# ...
```



## bringing data together in a spatial coding environment

Then in the practical, by way of example of the issues raised int he lecture, we will develop something that looks at where new cycle routes could be developed in Leeds
## looking at travel to work patterns in Leeds (formal census data)

## where cycling is supported by cycling routes (OSM data)

## then identify areas that would benefit from additional cycling routes

## we may even suggest potential routes! 
